<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TV Digital - Canal Sincronizado</title>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <style>
        :root {
            --naranja-metal: linear-gradient(180deg, #ff8c00 0%, #e65100 100%);
            --plyr-color-main: #ff6600;
        }

        body {
            background-color: #050505;
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Segoe UI', sans-serif;
            color: white;
        }

        /* Contenedor 16:9 exacto */
        .contenedor-tv {
            width: 95%;
            max-width: 900px;
            aspect-ratio: 16 / 9;
            background: var(--naranja-metal);
            padding: 6px;
            border-radius: 12px;
            box-shadow: 0 0 40px rgba(0,0,0,0.9);
            position: relative;
        }

        .pantalla {
            width: 100%;
            height: 100%;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        /* Notificaci贸n de Reloj Temporal */
        #notificacion-reloj {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.85);
            border-left: 4px solid #ff8c00;
            padding: 10px 15px;
            border-radius: 4px;
            font-size: 12px;
            transform: translateX(150%);
            transition: transform 0.5s ease;
            pointer-events: none;
        }

        .visible { transform: translateX(0) !important; }

        /* Icono de Sincronizar (Flotante) */
        .btn-sincro {
            position: absolute;
            top: 15px;
            left: 15px;
            z-index: 90;
            background: rgba(255, 140, 0, 0.2);
            border: 1px solid rgba(255, 140, 0, 0.5);
            color: #ff8c00;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 10px;
            font-weight: bold;
        }

        /* Barra Social Inferior (Fuera del video para no estorbar) */
        .social-bar {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn-social {
            padding: 8px 15px;
            border-radius: 5px;
            text-decoration: none;
            color: white;
            font-size: 12px;
            font-weight: bold;
            transition: 0.3s;
        }

        .ws { background: #25d366; }
        .fb { background: #1877f2; }
        .tg { background: #0088cc; }

        /* Loader */
        #loader {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 200;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
    </style>
</head>
<body>

<div class="contenedor-tv">
    <div class="pantalla">
        
        <div id="loader">
            <div style="width: 40px; height: 40px; border: 4px solid #333; border-top-color: #ff8c00; border-radius: 50%; animation: spin 1s linear infinite;"></div>
            <p style="font-size: 12px; margin-top: 10px;">CONECTANDO A LA SEAL...</p>
        </div>

        <div id="notificacion-reloj">
            <div style="opacity: 0.7; font-size: 10px;">PRXIMO PROGRAMA EN:</div>
            <div id="tiempo-restante" style="font-size: 16px; font-weight: bold; color: #ff8c00;">00:00:00</div>
        </div>

        <button class="btn-sincro" onclick="mostrarRelojYSincronizar()"> SINCRONIZAR VIVO</button>

        <video id="player" playsinline controls></video>
    </div>
</div>

<div class="social-bar">
    <a href="#" id="share-ws" class="btn-social ws" target="_blank">WhatsApp</a>
    <a href="#" id="share-fb" class="btn-social fb" target="_blank">Facebook</a>
    <a href="#" id="share-tg" class="btn-social tg" target="_blank">Telegram</a>
</div>

<script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
<script>
    const playlist = [
        { title: "Riesgo de Vuelo", url: "https://ia800900.us.archive.org/28/items/1.-riesgo-de-vuelo-2025-espanol_202506/1.Riesgo%20de%20vuelo%202025%F0%9F%87%AE%F0%9F%87%B9%20espa%C3%B1ol.mp4", dur: 7920 },
        { title: "Intensa Mente 2", url: "https://ia600900.us.archive.org/28/items/1.-riesgo-de-vuelo-2025-espanol_202506/Intensa%20Mente%202.mp4", dur: 5760 },
        { title: "C贸mo entrenar a tu drag贸n", url: "https://ia600900.us.archive.org/28/items/1.-riesgo-de-vuelo-2025-espanol_202506/C%C3%B3mo%20entrenar%20a%20tu%20drag%C3%B3n%202025.mp4", dur: 6000 }
    ];

    const player = new Plyr('#player', { 
        autoplay: true, 
        muted: true,
        ratio: '16:9',
        quality: { default: 720, options: [720] }
    });

    function sincronizar() {
        const total = playlist.reduce((a, b) => a + b.dur, 0);
        const cycleTime = Math.floor(Date.now() / 1000) % total;
        let accum = 0;

        for (let video of playlist) {
            if (cycleTime < accum + video.dur) {
                const seek = cycleTime - accum;
                player.source = { type: 'video', sources: [{ src: video.url, type: 'video/mp4' }] };
                player.once('ready', () => { 
                    player.currentTime = seek; 
                    player.play();
                    document.getElementById('loader').style.display = 'none';
                });
                break;
            }
            accum += video.dur;
        }
    }

    function mostrarRelojYSincronizar() {
        const total = playlist.reduce((a, b) => a + b.dur, 0);
        const cycleTime = Math.floor(Date.now() / 1000) % total;
        let accum = 0;

        for (let video of playlist) {
            if (cycleTime < accum + video.dur) {
                const diff = (accum + video.dur) - cycleTime;
                const h = Math.floor(diff / 3600);
                const m = Math.floor((diff % 3600) / 60);
                const s = diff % 60;
                document.getElementById('tiempo-restante').innerText = `${h}:${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
                break;
            }
            accum += video.dur;
        }

        const notif = document.getElementById('notificacion-reloj');
        notif.classList.add('visible');
        setTimeout(() => notif.classList.remove('visible'), 5000); // Se va a los 5 segundos
        sincronizar();
    }

    // Configuraci贸n de botones sociales
    const pageUrl = encodeURIComponent(window.location.href);
    const text = encodeURIComponent("隆Mira este canal de TV en vivo!");
    document.getElementById('share-ws').href = `https://api.whatsapp.com/send?text=${text}%20${pageUrl}`;
    document.getElementById('share-fb').href = `https://www.facebook.com/sharer/sharer.php?u=${pageUrl}`;
    document.getElementById('share-tg').href = `https://t.me/share/url?url=${pageUrl}&text=${text}`;

    document.addEventListener('DOMContentLoaded', sincronizar);
    player.on('ended', sincronizar);

    // Animaci贸n de spin
    const style = document.createElement('style');
    style.innerHTML = `@keyframes spin { 100% { transform: rotate(360deg); } }`;
    document.head.appendChild(style);
</script>

</body>
</html>
