<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canal TV Met谩lico - Sincron铆a Total</title>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <style>
        :root {
            --naranja-metal: linear-gradient(180deg, #ff8c00 0%, #e65100 100%);
            --plyr-color-main: #ff6600;
        }

        body {
            background-color: #050505;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Segoe UI', sans-serif;
            color: white;
            overflow: hidden;
        }

        .contenedor-tv {
            width: 98%;
            max-width: 900px;
            background: var(--naranja-metal);
            padding: 5px;
            border-radius: 20px;
            box-shadow: 0 0 50px rgba(255, 85, 0, 0.3);
            position: relative;
        }

        .pantalla {
            background: #000;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        /* T铆tulo y Pr贸ximo Programa */
        .header-tv {
            position: absolute;
            top: 0; left: 0; width: 100%;
            z-index: 10;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 15px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
            pointer-events: none;
        }

        .info-vivo {
            background: rgba(0,0,0,0.6);
            padding: 5px 12px;
            border-radius: 5px;
            border-left: 3px solid #ff8c00;
        }

        .proximo-reloj {
            background: #ff8c00;
            color: black;
            padding: 5px 12px;
            border-radius: 5px;
            font-size: 11px;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            pointer-events: auto;
            cursor: pointer;
            text-transform: uppercase;
        }

        /* Capa de Sincronizaci贸n */
        #loader-sincro {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 100;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 140, 0, 0.2);
            border-top: 5px solid #ff8c00;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Bot贸n Compartir Discreto */
        .btn-compartir {
            position: absolute;
            bottom: 60px;
            right: 20px;
            z-index: 10;
            background: rgba(0,0,0,0.5);
            border: 1px solid #ff8c00;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div class="contenedor-tv">
    <div class="pantalla">
        
        <div id="loader-sincro">
            <div class="spinner"></div>
            <p id="txt-sincro" style="margin-top:20px; font-weight: bold;">AJUSTANDO SEAL 720p...</p>
            <div id="cuenta" style="font-size: 30px; color: #ff8c00;">3</div>
        </div>

        <div class="header-tv">
            <div class="info-vivo">
                <div style="font-size: 10px; opacity: 0.8;">EN EMISIN:</div>
                <div id="titulo-video" style="font-size: 14px; font-weight: bold; color: #ffca28;">...</div>
            </div>
            <div class="proximo-reloj" onclick="iniciarSincronizacion()">
                Sincronizar Vivo<br>
                <span id="reloj-countdown">Calculando...</span>
            </div>
        </div>

        <button class="btn-compartir" onclick="compartir()"></button>

        <video id="player" playsinline controls></video>
    </div>
</div>

<script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
<script>
    const playlist = [
        { title: "Riesgo de Vuelo (2025)", url: "https://ia800900.us.archive.org/28/items/1.-riesgo-de-vuelo-2025-espanol_202506/1.Riesgo%20de%20vuelo%202025%F0%9F%87%AE%F0%9F%87%B9%20espa%C3%B1ol.mp4", dur: 7920 }, // 2h 12m
        { title: "Intensa Mente 2", url: "https://ia600900.us.archive.org/28/items/1.-riesgo-de-vuelo-2025-espanol_202506/Intensa%20Mente%202.mp4", dur: 5760 }, // 1h 36m
        { title: "C贸mo entrenar a tu drag贸n (2025)", url: "https://ia600900.us.archive.org/28/items/1.-riesgo-de-vuelo-2025-espanol_202506/C%C3%B3mo%20entrenar%20a%20tu%20drag%C3%B3n%202025.mp4", dur: 6000 } // 1h 40m
    ];

    const player = new Plyr('#player', { 
        autoplay: true, 
        muted: true,
        quality: { default: 720, options: [720] }, // Forzamos resoluci贸n 720p internamente
        controls: ['play', 'progress', 'current-time', 'mute', 'volume', 'fullscreen'] 
    });

    function actualizarReloj() {
        const durTotal = playlist.reduce((a, b) => a + b.dur, 0);
        const tiempoCiclo = Math.floor(Date.now() / 1000) % durTotal;
        
        let acum = 0;
        for (let video of playlist) {
            if (tiempoCiclo < acum + video.dur) {
                const restante = (acum + video.dur) - tiempoCiclo;
                const h = Math.floor(restante / 3600);
                const m = Math.floor((restante % 3600) / 60);
                const s = restante % 60;
                
                document.getElementById('reloj-countdown').innerText = `FALTAN: ${h > 0 ? h + ':' : ''}${m < 10 ? '0' + m : m}:${s < 10 ? '0' + s : s}`;
                document.getElementById('titulo-video').innerText = video.title;
                break;
            }
            acum += video.dur;
        }
    }

    setInterval(actualizarReloj, 1000);

    function sincronizar() {
        const durTotal = playlist.reduce((a, b) => a + b.dur, 0);
        const tiempoCiclo = Math.floor(Date.now() / 1000) % durTotal;
        let acum = 0;

        for (let video of playlist) {
            if (tiempoCiclo < acum + video.dur) {
                const punto = tiempoCiclo - acum;
                player.source = { type: 'video', sources: [{ src: video.url, type: 'video/mp4', size: 720 }] };
                player.once('ready', () => { 
                    player.currentTime = punto; 
                    player.play(); 
                });
                break;
            }
            acum += video.dur;
        }
    }

    function iniciarSincronizacion() {
        const loader = document.getElementById('loader-sincro');
        const cuenta = document.getElementById('cuenta');
        let seg = 3;
        loader.style.display = 'flex';
        cuenta.innerText = seg;

        const interval = setInterval(() => {
            seg--;
            cuenta.innerText = seg;
            if (seg <= 0) {
                clearInterval(interval);
                sincronizar();
                setTimeout(() => loader.style.display = 'none', 1000);
            }
        }, 1000);
    }

    function compartir() {
        navigator.clipboard.writeText(window.location.href);
        alert("Enlace copiado.");
    }

    document.addEventListener('DOMContentLoaded', sincronizar);
    player.on('ended', sincronizar);
</script>
</body>
</html>
